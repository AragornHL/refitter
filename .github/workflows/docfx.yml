name: Github Pages

on:
    workflow_dispatch:
    push:
      paths-ignore:
        - '**/*'
        - '!.github/workflows/docfx.yml'
        - '!src/**/*.csproj'
        - '!src/**/*.cs'
      branches:
        - 'main' 

jobs:
    publish-docs:
      runs-on: ubuntu-latest
      steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Dotnet Setup
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: 7.x
  
      - run: dotnet tool update -g docfx
      - run: docfx docs/docfx_project/docfx.json
  
      - name: Deploy
        uses: peaceiris/actions-gh-pages@v3
        with:
            deploy_key: ${{ secrets.PAT }}
            external_repository: refitter/refitter.github.io
            publish_dir: ./public
  